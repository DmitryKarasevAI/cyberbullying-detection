# Содержание проекта
## Дообучение BERT-like модели для классификации буллинга
### Постановка задачи
Задача: создать качественную инфраструктуру для обучения и деплоя моделей и реализовать в ней обучение и инференс модели, которая будет заниматься классификацией текстов на предмет травли в интернете.
Формат входных и выходных данных
Входные данные при обучении - два поля: Твит (string) и метка класса (int).
Входные данные при инференсе - одно поле: Твит (string).
Выходные данные - одно поле:  метка класса (int).
### Метрики
Основной метрикой помимо значения лосса на валидацонной выборке была выбрана Accuracy. Этот выбор был сделан на основе того, что классы сбалансированны и в данной конкретной задаче у нас нету задачи приоритезировать какой-либо класс над другим. Соответственно Accuracy достаточна для таких условий.
### Валидация и тест
Поскольку данные не являются временным рядом, то можно воспользоваться обычным стратифицированным случайным разбиением на train/test/val. Для того чтобы это разбиение было воспроизводимым, можно зафиксировать seed.
### Датасеты
Данные буду брать из датасета на Kaggle. Всего в датасете 47000 твитов с проставленными метками классов. В датасете 6 уникальных классов. Классы сбалансированы, в каждом классе примерно по 8000 примеров. 

https://www.kaggle.com/datasets/andrewmvd/cyberbullying-classification 
### Моделирование
#### Бейзлайн
Бейзлайном является константное предсказание и оно даёт Accuracy примерно 17%.
#### Модель 
Была обучена модель с нуля со следующей архитектурой: Encoder-like модель со слоями Self-Attention + MLP с пренормализацией (LayerNorm) и Skip-Connection. С дефолтным конфигом, который залит в репозиторий, была получена метрика Accuracy примерно 85% на валидационном датасете.

## Setup
Важно! Репозиторий использовал версию pytorch для cu128 версии ядер CUDA. Если Вам важно, чтобы модель быстро обучилась на GPU и у Вас локально стоит GPU с другой версией CUDA, то важно в pyproject.toml заменить [[tool.uv.index]] с cu128 на нужную вам версию, а также поменяйте имя в [tool.uv.sources]. После этого переустановите torch: uv remove/add torch

Создайте чистую директорию и последовательно выполните следующие команды:

git clone https://github.com/DmitryKarasevAI/cyberbullying-detection.git

cd .\cyberbullying-detection\

uv sync

uv run pre-commit install

uv run pre-commit run -a

## Train
В решении была использована система конфигов, поэтому все параметры предпроцессинга, гиперпараметры и параметры обучения настраиваются в папке configs. 
После того как Вы настроите все необходимые Вам параметры в соответствующих папках, то можете запускать обучение следующей командой (результат обучения сохранится в MLFlow registry вместе с конфигами и буден переведён в стадию Staging):

uv run python .\src\cyberbullying_detection\train.py
